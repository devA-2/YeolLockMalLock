<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org/DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.dev2.ylml.model.Manager_MemberIDao">

	<!-- 담당자 및 배송원 전체 정보조회 -->
	<!-- 테스트중 -->
	<select id="selectallDelivery" parameterType="java.util.Map"
	resultType="ManagerDto">
	SELECT EMAIL, NAME, PHONE_NUM, AUTH
	FROM "MEMBER" m
	WHERE AUTH IN (80,90) 
	</select>
	
	<!-- 상세 정보조회 -->
	<!-- 테스트중 -->
	<select id="selectDetail" parameterType="" 
	resultType="ManagerDto">
	SELECT EMAIL, NAME, PHONE_NUM, REG_DATE , LEAVE_DATE, AUTH
	FROM "MEMBER" m
	WHERE EMAIL = #{email}
	</select>
	
	<!-- 배송 정보조회 -->
	<!-- 테스트중 -->
	<select id="">
	SELECT DELIVERY_CODE,
	(SELECT CURRENT_LOC FROM DELIVERYMAN d WHERE DELIVERYMAN_ID =
	#{email}) AS CURRENT_LOC ,
	DELIVERY_START, DELIVERY_ARRIVE
	FROM DELIVERY d2
	WHERE DELIVERYMAN_ID = #{email}
	</select>
	
	<!-- 임시권한 담당자 및 배송원 정보조회 -->
	<!-- 수정중 -->
	<select id="selectTempDelivery" parameterType="java.util.Map"
	resultType="ManagerDto">
	SELECT M.NAME, M.PHONE_NUM, D.DELIVERY_CODE, DM.CURRENT_LOC
	FROM MEM M, DELIVERY D, DELIVERYMAN DM
	WHERE D.DELIVERYMAN_ID
	IN (SELECT EMAIL FROM MEM WHERE AUTH IN (88,99)) AND D.DELIVERYMAN_ID =
	DM.DELIVERYMAN_ID
	</select>
  	
  	<!-- 담당자 및 배송원 권한 부여 -->
  	<select id="modifyAuth" parameterType="ManagerDto">
	UPDATE MEM
	SET AUTH = #{auth}
	WHERE EMAIL = #{email}
	</select>
	
	<!-- 담당자 및 배송원의 아이디를 통해 정보 조회 
	(이메일, 이름, 핸드폰번호, 권한, 배송코드, 현재위치)-->
	<!-- 수정중 -->
	<select id="selectIdDelivery" parameterType="java.util.Map"
	resultType="ManagerDto">
	SELECT EMAIL, NAME, PHONE_NUM, AUTH,
	(SELECT CURRENT_LOC FROM DELIVERYMAN D WHERE DELIVERYMAN_ID =
	#{deliveryman_id}) AS CURRENT_LOC,
	(SELECT DELIVERY_CODE FROM DELIVERY D2 WHERE DELIVERYMAN_ID = 
	#{deliveryman_id}) AS DELIVERY_CODE
	FROM MEM
	WHERE EMAIL = #{email}
	</select>
  	
</mapper>
